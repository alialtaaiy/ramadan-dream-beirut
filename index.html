<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ØªÙ‚ÙˆÙŠÙ… Ø±Ù…Ø¶Ø§Ù† â€” Ø­Ù„Ù… Ø¨ÙŠØ±ÙˆØª</title>
  <link rel="icon" href="logo.png">

  <style>
    :root{
      --bg:#071826;
      --card:#0e2a3f;
      --gold:#f5c400;
      --text:#eaf2ff;
      --muted:#b9c7da;
      --line:rgba(255,255,255,.12);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:18px;
    }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 50% 0%, #0e3a55 0%, var(--bg) 55%);
      color:var(--text);
      padding: 18px;
    }
    .wrap{ max-width: 1100px; margin: 0 auto; }

    .top{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; margin-bottom: 14px; flex-wrap: wrap;
    }
    .brand{ display:flex; align-items:center; gap:14px; }
    .logo{
      width:74px; height:74px; border-radius:18px;
      background: linear-gradient(135deg, rgba(245,196,0,.25), rgba(255,255,255,.06));
      display:flex; align-items:center; justify-content:center;
      overflow:hidden; border:1px solid var(--line);
      flex: 0 0 auto;
    }
    .logo img{ width:100%; height:100%; object-fit:cover; display:block; }
    .title h1{ margin:0; font-size: 26px; color: var(--gold); }
    .title p{ margin:6px 0 0; color: var(--muted); font-size: 14px; }

    .actions{ display:flex; gap:10px; align-items:center; flex-wrap: wrap; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding: 7px 11px;
      border-radius: 999px;
      background: rgba(245,196,0,.10);
      border: 1px solid rgba(245,196,0,.30);
      color: var(--gold);
      font-size: 12px;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      overflow:hidden;
    }
    .cardHeader{
      padding: 14px 16px;
      background: rgba(0,0,0,.18);
      border-bottom: 1px solid var(--line);
      display:flex; align-items:center; justify-content:space-between; gap: 10px;
    }
    .cardHeader h2{
      margin:0; font-size: 16px; color: var(--gold);
      display:flex; align-items:center; gap:8px;
    }
    .cardBody{ padding: 16px; }

    .big{
      background: linear-gradient(180deg, rgba(245,196,0,.14), rgba(0,0,0,.20));
      border: 1px solid rgba(245,196,0,.30);
      border-radius: 16px;
      padding: 14px;
      display:grid;
      gap: 8px;
    }
    .big .k{ color: var(--muted); font-size: 12px; }
    .big .v{ font-size: 18px; font-weight: 900; }
    .big .vGold{ color: var(--gold); }

    .times{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    @media (max-width: 720px){
      .times{ grid-template-columns: 1fr 1fr; }
    }
    .t{
      background: rgba(0,0,0,.22);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
    }
    .t .name{ color: var(--muted); font-size: 12px; }
    .t .val{ font-size: 16px; font-weight: 900; margin-top: 6px; direction:ltr; text-align:left; }

    .btn{
      width:auto;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(245,196,0,.35);
      background: rgba(245,196,0,.10);
      color: var(--gold);
      font-weight: 900;
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{ background: rgba(245,196,0,.14); }

    .btns{ display:grid; gap:10px; margin-top: 12px; }
    .linkBtn{
      display:flex; align-items:center; justify-content:center; gap:10px;
      padding: 12px;
      border-radius: 16px;
      text-decoration:none;
      font-weight: 900;
      border: 1px solid rgba(245,196,0,.35);
      background: rgba(0,0,0,.22);
      color: var(--gold);
      transition: transform .08s ease;
    }
    .linkBtn:active{ transform: scale(.99); }
    .icon{
      width:30px; height:30px; display:grid; place-items:center;
      border-radius: 12px;
      background: rgba(245,196,0,.12);
      border: 1px solid rgba(245,196,0,.30);
      font-weight: 900;
    }
    .linkBtn.primary{
      background: linear-gradient(180deg, rgba(245,196,0,.20), rgba(0,0,0,.22));
    }

    /* Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… */
    .dua{
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(245,196,0,.25);
      border-radius: 16px;
      padding: 14px;
      margin-top: 12px;
      line-height: 1.9;
      text-align:right;
    }
    .dua .hd{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom: 10px;
    }
    .dua .hd .t{ color: var(--gold); font-weight: 900; }
    .dua .text{ color: var(--text); font-weight: 650; font-size: 14px; }
    .dua .src{ color: var(--muted); font-size: 12px; margin-top: 8px; }

    /* ØµÙˆØ± Ø§Ù„Ù…Ø·Ø¹Ù… (Ø³Ù„Ø§ÙŠØ¯Ø± Ù…ØªØ­Ø±Ùƒ) */
    .marquee{
      border: 1px solid var(--line);
      border-radius: 16px;
      overflow:hidden;
      background: rgba(0,0,0,.18);
      padding: 10px;
    }
    .track{
      display:flex;
      gap: 10px;
      width: max-content;
      animation: scroll 26s linear infinite;
    }
    .marquee:hover .track{ animation-play-state: paused; }
    @keyframes scroll{
      from{ transform: translateX(0); }
      to{ transform: translateX(-50%); }
    }
    .pic{
      width: 220px;
      height: 125px;
      border-radius: 14px;
      overflow:hidden;
      border: 1px solid rgba(245,196,0,.18);
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
      flex: 0 0 auto;
    }
    .pic img{ width:100%; height:100%; object-fit:cover; display:block; }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
    .modalWrap{
      position: fixed; inset: 0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center; justify-content:center;
      padding: 16px;
      z-index: 999;
    }
    .modal{
      width: min(920px, 100%);
      max-height: 90vh;
      overflow:auto;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(14,42,63,.98), rgba(7,24,38,.98));
      box-shadow: var(--shadow);
    }
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 520px){
      .row{ grid-template-columns: 1fr; }
    }
    label{ display:block; font-size: 13px; color: var(--muted); margin-bottom: 6px; text-align:right; }
    select, input{
      width:100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      font-size: 14px;
    }
    .hint{ font-size: 12px; color: var(--muted); margin-top: 6px; line-height:1.5; text-align:right; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo">
          <img src="logo.png" alt="Logo" />
        </div>
        <div class="title">
          <h1>ØªÙ‚ÙˆÙŠÙ… Ø±Ù…Ø¶Ø§Ù† â€” Ø­Ù„Ù… Ø¨ÙŠØ±ÙˆØª</h1>
          <p>Ù…Ø°Ø§Ù‚ Ø¨ÙŠØ±ÙˆØª Ø§Ù„Ø£ØµÙŠÙ„ Ø¨Ø£Ø·Ø¨Ø§Ù‚ ÙØ§Ø®Ø±Ø© ÙˆØ£Ø¬ÙˆØ§Ø¡ ØªØ£Ø®Ø°Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ù…ØªÙˆØ³Ø· â€¢ Ø§Ù„Ø¯ÙˆØ§Ù… 24 Ø³Ø§Ø¹Ø©</p>
        </div>
      </div>

      <div class="actions">
        <button id="toggleSettings" class="btn">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        <button id="btnToday" class="btn">Ø§Ù„ÙŠÙˆÙ…</button>
        <button id="btnRefreshTop" class="btn">ØªØ­Ø¯ÙŠØ«</button>
        <div class="pill" id="statusPill">Ø¬Ø§Ù‡Ø²</div>
      </div>
    </div>

    <div class="grid">
      <!-- Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ù‚ÙŠØª -->
      <div class="card">
        <div class="cardHeader">
          <h2>ğŸ•Œ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ù…ÙˆØ§Ù‚ÙŠØª</h2>
          <div class="pill" id="cityPill">Ø¨ØºØ¯Ø§Ø¯</div>
        </div>
        <div class="cardBody">
          <div class="big">
            <div class="k">Ø§Ù„ÙŠÙˆÙ…</div>
            <div class="v" id="line1">â€”</div>
            <div class="k">Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ</div>
            <div class="v vGold" id="hijriLine">â€”</div>
            <div class="k">Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ</div>
            <div class="v" id="gregLine">â€”</div>
          </div>

          <div class="times">
            <div class="t"><div class="name">Ø§Ù„Ø¥Ù…Ø³Ø§Ùƒ</div><div class="val" id="imsak">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„ÙØ¬Ø±</div><div class="val" id="fajr">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„Ø´Ø±ÙˆÙ‚</div><div class="val" id="sunrise">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„Ø¸Ù‡Ø±</div><div class="val" id="dhuhr">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„Ø¹ØµØ±</div><div class="val" id="asr">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„Ù…ØºØ±Ø¨ (Ø§Ù„Ø¥ÙØ·Ø§Ø±)</div><div class="val" id="maghrib">â€”</div></div>
            <div class="t"><div class="name">Ø§Ù„Ø¹Ø´Ø§Ø¡</div><div class="val" id="isha">â€”</div></div>
          </div>

          <!-- Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ… -->
          <div class="dua">
            <div class="hd">
              <div class="t">ğŸ¤² Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…</div>
              <div class="pill" id="duaDayPill">â€”</div>
            </div>
            <div class="text" id="duaText">â€”</div>
            <div class="src">ÙŠØªØºÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
          </div>

          <div class="btns">
            <a class="linkBtn primary" href="https://www.facebook.com/helemrest/" target="_blank" rel="noopener">
              <span class="icon">f</span> Facebook
            </a>
            <a class="linkBtn" href="https://www.instagram.com/helem.rest?igsh=bHU3azE0dGdseGVv" target="_blank" rel="noopener">
              <span class="icon">âŒ</span> Instagram
            </a>
            <a class="linkBtn" href="https://wa.me/9647701111722" target="_blank" rel="noopener">
              <span class="icon">âœ†</span> ÙˆØ§ØªØ³Ø§Ø¨: +964 770 111 1722
            </a>
          </div>
        </div>
      </div>

      <!-- ØµÙˆØ± Ø§Ù„Ù…Ø·Ø¹Ù… -->
      <div class="card">
        <div class="cardHeader">
          <h2>ğŸ½ï¸ ØµÙˆØ± Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…</h2>
        </div>
        <div class="cardBody">
          <div class="marquee">
            <div class="track" id="imgTrack"></div>
          </div>
          <div class="hint" style="margin-top:10px;">
            Ø§Ù„ØµÙˆØ± ØªÙÙ‚Ø±Ø£ Ù…Ù†: images/1.jpg, images/2.jpg, images/3.jpg, images/4.jpg (ØªÙ‚Ø¯Ø± ØªØ²ÙŠØ¯ Ù„Ø§Ø­Ù‚Ø§Ù‹)
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <div class="modalWrap" id="settingsModal" aria-hidden="true">
    <div class="modal card">
      <div class="cardHeader">
        <h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
        <div style="display:flex; gap:10px;">
          <button id="btnSave" class="btn">Ø­ÙØ¸</button>
          <button id="btnClose" class="btn">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      </div>
      <div class="cardBody">
        <div class="row">
          <div>
            <label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
            <select id="city">
              <option value="Baghdad">Ø¨ØºØ¯Ø§Ø¯</option>
              <option value="Basra">Ø§Ù„Ø¨ØµØ±Ø©</option>
            </select>
            <div class="hint">Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: Ø¨ØºØ¯Ø§Ø¯ (Ø£ÙˆÙ„ Ù…Ø±Ø©) Ø«Ù… ÙŠØ­ÙØ¸ Ø¢Ø®Ø± Ø§Ø®ØªÙŠØ§Ø±.</div>
          </div>

          <div>
            <label>Ø§Ù„Ù…Ø°Ù‡Ø¨</label>
            <select id="sect">
              <option value="sunni">Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø³Ù†ÙŠ</option>
              <option value="shia">Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø´ÙŠØ¹ÙŠ</option>
            </select>
            <div class="hint">Ø¹Ù†Ø¯Ùƒ Ø¹Ø§Ø¯Ø©Ù‹: Ø§Ù„Ø³Ù†ÙŠ ÙŠØ³Ø¨Ù‚ Ø§Ù„Ø´ÙŠØ¹ÙŠ Ø¨ÙŠÙˆÙ….</div>
          </div>

          <div>
            <label>ØªØµØ­ÙŠØ­ (Â±1 ÙŠÙˆÙ…)</label>
            <select id="offset">
              <option value="0">0 (Ø¨Ø¯ÙˆÙ† ØªØµØ­ÙŠØ­)</option>
              <option value="1">+1 ÙŠÙˆÙ…</option>
              <option value="-1">-1 ÙŠÙˆÙ…</option>
            </select>
          </div>

          <div>
            <label>Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input id="date" type="date"/>
            <div class="hint">Ø¥Ø°Ø§ ÙØ§Ø±ØºØŒ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  const $ = (id) => document.getElementById(id);

  const DEFAULTS = {
    city: "Baghdad",
    sect: "sunni",
    sectOffsetSunni: 0,
    sectOffsetShia: -1,
    manualOffset: 0
  };

  function setStatus(t){ $("statusPill").textContent = t; }

  function loadSettings(){
    const saved = JSON.parse(localStorage.getItem("hb_ramadan_settings") || "null");
    $("city").value = (saved && saved.city) ? saved.city : DEFAULTS.city;
    $("sect").value = (saved && saved.sect) ? saved.sect : DEFAULTS.sect;
    $("offset").value = String((saved && typeof saved.manualOffset === "number") ? saved.manualOffset : DEFAULTS.manualOffset);
    if (saved?.date) $("date").value = saved.date;
  }

  function saveSettings(){
    const data = {
      city: $("city").value,
      sect: $("sect").value,
      manualOffset: parseInt($("offset").value,10) || 0,
      date: $("date").value || ""
    };
    localStorage.setItem("hb_ramadan_settings", JSON.stringify(data));
  }

  function getBaseDate(){
    const v = $("date").value;
    if (v) return new Date(v + "T00:00:00");
    const now = new Date();
    return new Date(now.getFullYear(), now.getMonth(), now.getDate());
  }
  function addDays(date, days){
    const d = new Date(date);
    d.setDate(d.getDate() + days);
    return d;
  }
  function getDisplayDate(){
    const base = getBaseDate();
    const sect = $("sect").value;
    const manualOffset = parseInt($("offset").value,10) || 0;
    const sectOffset = (sect === "shia") ? DEFAULTS.sectOffsetShia : DEFAULTS.sectOffsetSunni;
    return addDays(base, sectOffset + manualOffset);
  }

  function getIslamicParts(date){
    const fmt = new Intl.DateTimeFormat("ar-IQ-u-ca-islamic", { day:"numeric", month:"numeric", year:"numeric" });
    const parts = fmt.formatToParts(date);
    const get = (t) => parts.find(p=>p.type===t)?.value;
    const toEn = (s) => String(s)
      .replace(/[Ù -Ù©]/g, d => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d))
      .replace(/[Û°-Û¹]/g, d => "Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹".indexOf(d));
    return {
      day: parseInt(toEn(get("day")),10),
      month: parseInt(toEn(get("month")),10),
      year: parseInt(toEn(get("year")),10),
      rawText: fmt.format(date)
    };
  }

  function formatGregorian(date){
    return new Intl.DateTimeFormat("ar-IQ", { weekday:"long", year:"numeric", month:"long", day:"numeric" }).format(date);
  }
  function getRamadanDay(isl){
    if (isl.month !== 9) return null;
    return isl.day;
  }

  function toAmPm(hhmm){
    if (!hhmm || hhmm === "â€”") return "â€”";
    const m = String(hhmm).match(/^(\d{1,2}):(\d{2})/);
    if(!m) return hhmm;
    let h = parseInt(m[1],10);
    const min = m[2];
    const ampm = (h >= 12) ? "PM" : "AM";
    h = h % 12; if (h === 0) h = 12;
    return `${h}:${min} ${ampm}`;
  }

  async function fetchTimings(date, city){
    const d = String(date.getDate()).padStart(2,"0");
    const m = String(date.getMonth()+1).padStart(2,"0");
    const y = String(date.getFullYear());
    const url = `https://api.aladhan.com/v1/timingsByCity/${d}-${m}-${y}?city=${encodeURIComponent(city)}&country=Iraq&method=4`;
    const res = await fetch(url);
    const json = await res.json();
    const t = json?.data?.timings;
    const clean = (v) => String(v).slice(0,5);
    return {
      imsak: clean(t.Imsak || t.Fajr),
      fajr: clean(t.Fajr),
      sunrise: clean(t.Sunrise),
      dhuhr: clean(t.Dhuhr),
      asr: clean(t.Asr),
      maghrib: clean(t.Maghrib),
      isha: clean(t.Isha)
    };
  }

  const DUAS = [
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ÙŠÙ†ØŒ ÙˆØ§ØºÙØ± Ù„Ù†Ø§ ÙˆØ§Ø±Ø­Ù…Ù†Ø§ Ø¨Ø±Ø­Ù…ØªÙƒ ÙŠØ§ Ø£Ø±Ø­Ù… Ø§Ù„Ø±Ø§Ø­Ù…ÙŠÙ†.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†Ø§ ØµØ¯Ù‚ Ø§Ù„ØªÙˆØ¨Ø©ØŒ ÙˆØµÙØ§Ø¡ Ø§Ù„Ù‚Ù„Ø¨ØŒ ÙˆØ­Ø³Ù† Ø§Ù„Ø®Ø§ØªÙ…Ø©ØŒ ÙˆØ¨Ø§Ø±Ùƒ Ù„Ù†Ø§ ÙÙŠ Ø£Ø¹Ù…Ø§Ù„Ù†Ø§.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… ÙØ±Ø¬Ø§Ù‹ Ù„ÙƒÙ„ Ù…Ù‡Ù…ÙˆÙ…ØŒ ÙˆØ´ÙØ§Ø¡Ù‹ Ù„ÙƒÙ„ Ù…Ø±ÙŠØ¶ØŒ ÙˆØ±Ø²Ù‚Ø§Ù‹ ÙˆØ§Ø³Ø¹Ø§Ù‹ Ù„Ù†Ø§ ÙˆÙ„Ø£Ù‡Ù„Ù†Ø§.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù†Ø§ Ù…Ù† Ø£Ù‡Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŒ ÙˆÙˆÙÙ‚Ù†Ø§ Ù„Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„ØŒ ÙˆØ§ØºØ³Ù„ Ù‚Ù„ÙˆØ¨Ù†Ø§ Ù…Ù† ÙƒÙ„ Ù‡Ù…Ù‘ ÙˆØ­Ø²Ù†.",
    "Ø§Ù„Ù„Ù‡Ù… ØªÙ‚Ø¨Ù„ ØµÙŠØ§Ù…Ù†Ø§ ÙˆÙ‚ÙŠØ§Ù…Ù†Ø§ØŒ ÙˆØ§Ù‡Ø¯Ù†Ø§ Ù„Ø£Ø­Ø³Ù† Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ Ù„Ø§ ÙŠÙ‡Ø¯ÙŠ Ù„Ø£Ø­Ø³Ù†Ù‡Ø§ Ø¥Ù„Ø§ Ø£Ù†Øª.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø±Ø²Ù‚Ù†Ø§ Ø¨Ø±ÙƒØ© Ø§Ù„ÙˆÙ‚ØªØŒ ÙˆÙ†ÙˆØ± Ø§Ù„Ø¨ØµÙŠØ±Ø©ØŒ ÙˆØ±Ø§Ø­Ø© Ø§Ù„Ø¨Ø§Ù„ØŒ ÙˆØ³Ø¹Ø© Ø§Ù„Ø±Ø²Ù‚.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ù„Ù†Ø§ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… Ø¯Ø¹ÙˆØ© Ù„Ø§ ØªÙØ±Ø¯ØŒ ÙˆØ§ÙØªØ­ Ù„Ù†Ø§ Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø®ÙŠØ± Ù…Ù† Ø­ÙŠØ« Ù„Ø§ Ù†Ø­ØªØ³Ø¨.",
    "Ø§Ù„Ù„Ù‡Ù… Ø§Ø­ÙØ¸ Ø£Ù‡Ù„Ù†Ø§ ÙˆØ£ÙˆÙ„Ø§Ø¯Ù†Ø§ ÙˆØ¨Ù„Ø¯Ù†Ø§ØŒ ÙˆØ£Ø¯Ù… Ø¹Ù„ÙŠÙ†Ø§ Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ø¹Ø§ÙÙŠØ© ÙˆØ§Ù„Ø³ØªØ±."
  ];
  function getDuaForDay(ramDay){
    const key = ramDay ? ramDay : (new Date().getDate());
    return DUAS[(key - 1) % DUAS.length];
  }

  function buildImageMarquee(){
    const imgs = ["images/1.jpg","images/2.jpg","images/3.jpg","images/4.jpg"];
    const track = $("imgTrack");
    track.innerHTML = "";
    const full = imgs.concat(imgs);
    full.forEach(src=>{
      const div = document.createElement("div");
      div.className = "pic";
      const img = document.createElement("img");
      img.src = src;
      img.alt = "Ø­Ù„Ù… Ø¨ÙŠØ±ÙˆØª";
      img.onerror = ()=> div.style.display="none";
      div.appendChild(img);
      track.appendChild(div);
    });
  }

  async function render(){
    setStatus("ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«â€¦");

    const date = getDisplayDate();
    const city = $("city").value;
    const sect = $("sect").value;

    $("cityPill").textContent = (city === "Basra") ? "Ø§Ù„Ø¨ØµØ±Ø©" : "Ø¨ØºØ¯Ø§Ø¯";

    const isl = getIslamicParts(date);
    const ramDay = getRamadanDay(isl);

    const sectLabel = (sect === "shia") ? "Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø´ÙŠØ¹ÙŠ" : "Ø§Ù„ÙˆÙ‚Ù Ø§Ù„Ø³Ù†ÙŠ";
    $("line1").textContent = ramDay
      ? `Ø§Ù„ÙŠÙˆÙ… ${ramDay} Ø±Ù…Ø¶Ø§Ù† ${isl.year} Ù‡Ù€ (${sectLabel})`
      : `Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø­Ø³Ø¨ ${sectLabel})`;

    $("hijriLine").textContent = isl.rawText;
    $("gregLine").textContent = formatGregorian(date);

    $("duaDayPill").textContent = ramDay ? `Ø§Ù„ÙŠÙˆÙ… ${ramDay}` : "Ø§Ù„ÙŠÙˆÙ…";
    $("duaText").textContent = getDuaForDay(ramDay);

    try{
      const t = await fetchTimings(date, city);
      $("imsak").textContent   = toAmPm(t.imsak);
      $("fajr").textContent    = toAmPm(t.fajr);
      $("sunrise").textContent = toAmPm(t.sunrise);
      $("dhuhr").textContent   = toAmPm(t.dhuhr);
      $("asr").textContent     = toAmPm(t.asr);
      $("maghrib").textContent = toAmPm(t.maghrib);
      $("isha").textContent    = toAmPm(t.isha);

      setStatus("ØªÙ… âœ…");
      setTimeout(()=>setStatus("Ø¬Ø§Ù‡Ø²"), 1200);
    }catch(e){
      ["imsak","fajr","sunrise","dhuhr","asr","maghrib","isha"].forEach(id=> $(id).textContent="â€”");
      setStatus("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª");
    }
  }

  function openSettings(){
    $("settingsModal").style.display = "flex";
    $("settingsModal").setAttribute("aria-hidden","false");
  }
  function closeSettings(){
    $("settingsModal").style.display = "none";
    $("settingsModal").setAttribute("aria-hidden","true");
  }

  $("toggleSettings").addEventListener("click", openSettings);
  $("btnClose").addEventListener("click", closeSettings);
  $("settingsModal").addEventListener("click", (e)=>{
    if (e.target === $("settingsModal")) closeSettings();
  });

  $("btnSave").addEventListener("click", ()=>{ saveSettings(); closeSettings(); render(); setStatus("ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…"); });
  $("btnRefreshTop").addEventListener("click", render);
  $("btnToday").addEventListener("click", ()=>{ $("date").value=""; saveSettings(); render(); });

  $("city").addEventListener("change", render);
  $("sect").addEventListener("change", render);
  $("offset").addEventListener("change", render);
  $("date").addEventListener("change", render);

  loadSettings();
  closeSettings();
  buildImageMarquee();
  render();
</script>
</body>
</html>
